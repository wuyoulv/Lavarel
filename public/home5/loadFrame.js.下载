!function(){"use strict";function t(){var t=L;if(v&&t.length){L=[];for(var o=0;o<t.length;o+=1)t[o](_)}}function o(){v||(v=!0,w&&clearInterval(w),t())}function n(t){return v?t(_):L.push(t),n}function e(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?b[E.call(t)]||"object":typeof t}function i(t){return"function"===e(t)}function a(t,o){if(o=o||"YK-Module-CSS",!document.getElementById(o)){var n=document.getElementsByTagName("head")[0],e=document.createElement("link");e.id=o,e.rel="stylesheet",e.href=t;var i=n.getElementsByTagName("style");i.length>0?n.insertBefore(e,i[0]):n.appendChild(e)}}function r(t,o,n){"function"==typeof o&&(n=o,o={});var e=document.createElement("script");e.type="text/javascript";for(var i in o)e.setAttribute(i,o[i]);e.src=t;var a=document.getElementsByTagName("head")[0],r=!1;e.onload=e.onreadystatechange=function(){r||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(r=!0,e.onload=e.onreadystatechange=null,a.removeChild(e),n&&n())},a.appendChild(e)}function c(){}function l(t,o,n){function e(){a.parentNode&&a.parentNode.removeChild(a),window[s]=c,r&&clearTimeout(r)}function i(){window[s]&&e()}"function"==typeof o&&(n=o,o={}),o||(o={});var a,r,l=o.prefix||"__jp",s=o.name||l+j++,u=o.param||"callback",d=null!=o.timeout?o.timeout:6e4,f=encodeURIComponent,g=document.getElementsByTagName("script")[0]||document.head;return d&&(r=setTimeout(function(){e(),n&&n(new Error("请求超时，请重试"))},d)),window[s]=function(t){e(),n&&n(t)},t+=(~t.indexOf("?")?"&":"?")+u+"="+f(s),t=t.replace("?&","?"),a=document.createElement("script"),a.src=t,g.parentNode.insertBefore(a,g),i}var s=Array.prototype,u=s.slice,d=Object,f=d.prototype,g=String.prototype,p=Function.prototype,h=function(){};window.console||(window.console={log:h,error:h}),g.trim||(g.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),s.filter||(s.filter=function(t,o){for(var n=[],e=0,i=this.length;e<i;e++)e in this&&t.call(o,this[e],e,this)&&n.push(this[e]);return n}),s.forEach||(s.forEach=function(t,o){for(var n=0,e=this.length;n<e;n++)n in this&&t.call(o,this[n],n,this)}),s.map||(s.map=function(t,o){for(var n=0,e=this.length,i=new Array(e);n<e;n++)n in this&&(i[n]=t.call(o,this[n],n,this));return i}),s.indexOf||(s.indexOf=function(t,o){var n=this.length;for(o=parseInt(o)||0,o<0&&(o+=n);o<n;o++)if(o in this&&this[o]===t)return o;return-1}),Array.from||(Array.from=function(){return u.call(arguments)}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===f.toString.call(t)}),Date.now||(Date.now=function(){return+new Date}),d.keys||(d.keys=function(t){var o,n=[];for(o in t)f.hasOwnProperty.call(t,o)&&n.push(o);return n}),d.create||(d.create=function(t){function o(){}return o.prototype=t,new o}),d.assign||(d.assign=function(t){function o(t,o){for(var e=1;e<arguments.length;e++)n(t,arguments[e]);return t}function n(o,n){for(var e in n)t.call(n,e)&&(o[e]=n[e])}return o}(f.hasOwnProperty)),p.bind||(p.bind=function(t){var o=u.call(arguments,1),n=this,e=function(){},i=function(){return n.apply(this instanceof e?this:t||window,o.concat(u.call(arguments)))};return e.prototype=this.prototype,i.prototype=new e,i});var m,y,w,v,_=document,L=[];if(document.addEventListener)document.addEventListener("DOMContentLoaded",o,!1),window.addEventListener("load",o,!1);else if(window.attachEvent){window.attachEvent("onload",o),y=document.createElement("div");try{m=null===window.frameElement}catch(B){}y.doScroll&&m&&window.external&&(w=setInterval(function(){try{y.doScroll(),o()}catch(B){}},30))}"complete"===document.readyState&&o();var b={},S="Boolean Number String Function Array Date RegExp Object".split(" "),F=Object.prototype,E=F.toString;S.forEach(function(t){b["[object "+t+"]"]=t.toLowerCase()});var j=(/(msie) ([\w.]+)/.exec(navigator.userAgent),0),C=function(){},T="//g.alicdn.com/static-es6/login/pc/login/js/main_bfbe437.js",O="//g.alicdn.com/static-es6/login/pc/login/css/main_495c9db.css",k="//g.alicdn.com/static-es6/login/h5/login/js/main_bfbe437.js",A="//g.alicdn.com/static-es6/login/h5/login/css/main_5de0639.css",D=void 0,N=void 0,x=function(){function t(t){this.config=t=t||{},t.isMobile=t.template&&t.template.toLowerCase().indexOf("mobile")>-1||!1,t.logoutSuccess=t.logoutSuccess||function(){window.location.reload()},this.loadMode=t.loadMode||t.loginOrLogout||"login",this.loadFail=t.loadFail||t.loadfail||C,this.loadSuccess=t.loadSuccess||t.loadSucess||C,this.styleSrc=t.isMobile?A:O,this.scriptSrc=t.isMobile?k:T,this.init()}return t.prototype.init=function(){var t=this.config;this._loadLoginFail=!1,this._loadLogoutFail=!1,"login"==this.loadMode?(this._getConfig("login"),this._loadLogin(function(){D=new loginFrame(t)})):this._loadLogout(function(){N=new logoutFrame(t)})},t.prototype.buildLoginDom=function(t){this._addTask(function(){D.buildLoginDom(t)})},t.prototype.buildRegDom=function(t){this._addTask(function(){D.buildRegDom(t)})},t.prototype.closeFrame=function(t){D&&D.closeFrame(t)},t.prototype._addTask=function(t){var o=this;this._loadLoginError||(D?i(t)&&t():this._taskTimer=setTimeout(function(){o._addTask(t)},10))},t.prototype._getConfig=function(t){var o=this,n=this.config,e=window.location.protocol||"https:",i=n.accountDomain||"account.youku.com";i=i.replace(/^https?:\/\/|^\/\//i,""),l(e+"//"+i+"/getConfig.json?pid="+(n.pid||"")+"&bizType="+(t||"")+"&callback="+encodeURIComponent(n.callbackURL||""),{param:"jsonpCallback",timeout:1e3},function(t){o._loadLoginSuccess||t&&"success"==t.result&&(window.__YK_PRELOAD_LOGIN_CONFIG__=t.data)})},t.prototype._loadLogin=function(t){var o=this;a(this.styleSrc,"YT-loginFrameCss"),setTimeout(function(){window.loginFrame?i(t)&&t():r(o.scriptSrc,function(){o._loadLoginSuccess=!0,window.loginFrame?(i(t)&&t(),i(o.loadSuccess)&&o.loadSuccess()):o._loadLoginFail?(o._loadLoginError=!0,i(o.loadFail)&&o.loadFail()):(o._loadLoginFail=!0,o._loadLogin(t))})},this._loadLoginFail?0:50)},t.prototype._loadLogout=function(t){var o=this;r("//g.alicdn.com/static-es6/login/public/logout_cfa7fbb.js",function(){window.logoutFrame?(i(t)&&t(),i(o.loadSuccess)&&o.loadSuccess()):o._loadLogoutFail?i(o.loadFail)&&o.loadFail():(o._loadLogoutFail=!0,o._loadLogout(t))})},t}();x.ready=n,window.YKLoginLoader=window.YKLoginLoader||x,window.getLoginFrame=window.getLoginFrame||x}();